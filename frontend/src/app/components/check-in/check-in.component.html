<h2 class="title">Check In</h2>

<div class="container">
  <div class="form-wrapper">
    <mat-horizontal-stepper [linear]="true" #stepper headerPosition="bottom">
      <mat-step [stepControl]="carInformationFormGroup" label="Car Information">
        <form [formGroup]="carInformationFormGroup">
          <mat-card class="form-container">
            <mat-card-header>
              <h3 class="title">Rental Information</h3>
            </mat-card-header>
            <mat-card-content>
              <mat-divider></mat-divider><br />

              <div>
                <mat-form-field appearance="outline" class="readonly-field">
                  <mat-label>Rental Number</mat-label>
                  <input matInput formControlName="rentalnr" />
                </mat-form-field>
              </div>
              <h3 class="title">Customer Information</h3>

              <mat-divider></mat-divider><br />
              <div class="grid-fields">
                <mat-form-field class="gray-bg" appearance="fill">
                  <mat-label>Customer Name</mat-label>
                  <input
                    matInput
                    type="number"
                    formControlName="customername"
                  />
                </mat-form-field>
                <mat-form-field class="gray-bg" appearance="fill">
                  <mat-label>Customer Last Name</mat-label>
                  <input matInput formControlName="customerlname" />
                </mat-form-field>
              </div>
              <h3 class="title">Car Information</h3>

              <mat-divider></mat-divider><br />
              <div class="grid-fields">
                <mat-form-field class="gray-bg" appearance="fill">
                  <mat-label>Car Group</mat-label>
                  <input matInput formControlName="carGroup" />
                </mat-form-field>
                <mat-form-field class="gray-bg" appearance="fill">
                  <mat-label>License Plate</mat-label>
                  <input matInput formControlName="licensePlate" />
                </mat-form-field>
                <mat-form-field class="gray-bg" appearance="fill">
                  <mat-label>Fuel</mat-label>
                  <input matInput formControlName="fuel" />
                </mat-form-field>
                <mat-form-field class="gray-bg" appearance="fill">
                  <mat-label>Car Model</mat-label>
                  <input matInput formControlName="carModel" />
                </mat-form-field>
                <mat-form-field class="gray-bg" appearance="fill">
                  <mat-label>Millage</mat-label>
                  <input matInput formControlName="millage" />
                </mat-form-field>
              </div>
              <div class="grid-fields">
                <mat-form-field class="gray-bg" appearance="fill">
                  <mat-label>Color</mat-label>
                  <input matInput formControlName="color" />
                </mat-form-field>
                <mat-form-field class="gray-bg" appearance="fill">
                  <mat-label>Status</mat-label>
                  <input matInput formControlName="status" />
                </mat-form-field>
                <mat-form-field class="gray-bg" appearance="fill">
                  <mat-label>Transmission</mat-label>
                  <input matInput formControlName="transmission" />
                </mat-form-field>
              </div>

              <div class="button-group">
                <button mat-button matStepperNext>Next</button>
              </div>
            </mat-card-content>
          </mat-card>
        </form>
      </mat-step>

      <mat-step [stepControl]="checkInForm" label="Check In">
        <form [formGroup]="checkInForm" (keydown.enter)="focusNext($event)">
          <mat-card class="form-container">
            <mat-card-content>
              <div class="car-date-row">
                <div>
                  <h3>Date</h3>
                  <mat-divider></mat-divider>
                  <mat-form-field class="gray-bg" appearance="fill">
                    <mat-label>Actual Check Out Date</mat-label>
                    <input
                      matInput
                      [matDatepicker]="checkOutDatePicker"
                      formControlName="actualCheckOutDate"
                      (dateChange)="updateActualCheckOut()"
                    />
                    <mat-datepicker-toggle
                      matSuffix
                      [for]="checkOutDatePicker"
                    ></mat-datepicker-toggle>
                    <mat-datepicker
                      #checkOutDatePicker
                      [touchUi]="true"
                    ></mat-datepicker>
                  </mat-form-field>

                  <div class="row-fields">
                    <mat-form-field appearance="outline" class="readonly-field">
                      <mat-label>Actual Check In Date</mat-label>
                      <input
                        matInput
                        [matDatepicker]="checkInDatePicker"
                        formControlName="actualCheckInDate"
                        (dateChange)="updateActualCheckIn()"
                      />
                      <mat-datepicker-toggle
                        matSuffix
                        [for]="checkInDatePicker"
                      ></mat-datepicker-toggle>
                      <mat-datepicker
                        #checkInDatePicker
                        [touchUi]="true"
                      ></mat-datepicker>
                    </mat-form-field>
                  </div>
                </div>
                <div>
                  <h3>Time</h3>
                  <mat-divider></mat-divider>
                <mat-form-field class="gray-bg" appearance="fill">
                    <mat-label>Check Out Time</mat-label>
                    <input
                      matInput
                      type="time"
                      formControlName="actualCheckOutTime"
                      (timeSet)="updateActualCheckOut()"
                    />
                    <ngx-material-timepicker
                      #checkOutTimePicker
                    ></ngx-material-timepicker>
                  </mat-form-field>
                  <mat-form-field appearance="outline" class="readonly-field">
                    <mat-label>Time</mat-label>
                    <input
                      matInput
                      type="time"
                      formControlName="actualCheckInTime"
                      (timeSet)="updateActualCheckIn()"
                    />
                    <ngx-material-timepicker
                      #checkInTimePicker
                    ></ngx-material-timepicker>
                  </mat-form-field>
                </div>
              </div>

              <div class="grid-two-columns">
              

                <div>
                  <h3>Mileage</h3>
                  <mat-divider></mat-divider>
                <mat-form-field class="gray-bg" appearance="fill">
                    <mat-label>KM Out</mat-label>
                    <input matInput formControlName="kmOut" />
                  </mat-form-field>
                  <mat-form-field appearance="outline" class="readonly-field">
                    <mat-label>KM In</mat-label>
                    <input matInput formControlName="kmIn" />
                  </mat-form-field>
                  <mat-form-field appearance="outline" class="readonly-field">
                    <mat-label>Mileage Additional Amount</mat-label>
                    <input matInput formControlName="mileageExtra" />
                  </mat-form-field>
                </div>

                <div>
                  <h3>Fuel</h3>
                  <mat-divider></mat-divider>
                <mat-form-field class="gray-bg" appearance="fill">
                    <mat-label>Fuel Out</mat-label>
                    <input matInput formControlName="fuelOut" />
                  </mat-form-field>
                  <mat-form-field appearance="outline" class="readonly-field">
                    <mat-label>Fuel In</mat-label>
                    <input matInput formControlName="fuelIn" />
                  </mat-form-field>
                  <mat-form-field appearance="outline" class="readonly-field">
                    <mat-label>Fuel Additional Amount</mat-label>
                    <input matInput formControlName="fuelExtra" />
                  </mat-form-field>
                </div>
              </div>

              <div class="button-group">
                <button
                  mat-raised-button
                  class="bluebutton"
                  (click)="toggleAdditionalFees()"
                >
                  Add Additional Fees
                </button>
                <button
                  mat-raised-button
                  class="bluebutton"
                  (click)="addDamage()"
                >
                  Add Damage
                </button>
              </div>

              <mat-card *ngIf="showAdditionalFees" class="form-container">
                <h3>Additional Fees</h3>
                <mat-divider></mat-divider><br />
                <mat-card-content>
                  <div formArrayName="additionalFees">
                    <div
                      *ngFor="let fee of additionalFees.controls; let i = index"
                      [formGroupName]="i"
                      class="fee-row"
                    >
                      <mat-form-field
                        appearance="outline"
                        class="readonly-field"
                      >
                        <mat-label>Additional Fee</mat-label>
                        <mat-select formControlName="feeType">
                          <mat-option value="tax">Tax (€50)</mat-option>
                          <mat-option value="cleaning"
                            >Cleaning (€30)</mat-option
                          >
                          <mat-option value="carTank"
                            >Car Tank (€40)</mat-option
                          >
                          <mat-option value="damage">Damage (€25)</mat-option>
                          <mat-option value="aiport"
                            >Airport Change (€25)</mat-option
                          >
                          <mat-option value="delayed"
                            >Delayed CheckIN (€25)</mat-option
                          >
                          <mat-option value="other">Other</mat-option>
                        </mat-select>
                      </mat-form-field>
                      <mat-form-field
                        appearance="outline"
                        class="readonly-field"
                      >
                        <mat-label>Price (€)</mat-label>
                        <input
                          matInput
                          type="number"
                          formControlName="price"
                          placeholder="e.g. 50"
                        />
                      </mat-form-field>
                      <button
                        mat-icon-button
                        color="warn"
                        (click)="removeAdditionalFee(i)"
                      >
                        <mat-icon>delete</mat-icon>
                      </button>
                    </div>
                    <div class="add-fee-container">
                      <button
                        mat-mini-fab
                        color="primary"
                        (click)="addAdditionalFees()"
                      >
                        <mat-icon>add</mat-icon>
                      </button>
                    </div>
                  </div>
                </mat-card-content>
              </mat-card>

              <div class="grid-two-columns">
                <div>
                  <h3>Gross Amount</h3>
                  <mat-divider></mat-divider>
                 
                <mat-form-field class="gray-bg" appearance="fill">
                    <mat-label>Check Out Price</mat-label>
                    <input matInput formControlName="checkOutPrice" />
                  </mat-form-field>
                  <mat-form-field appearance="outline" class="readonly-field">
                    <mat-label>Check In Price</mat-label>
                    <input matInput formControlName="checkInPrice" />
                  </mat-form-field>
                  <mat-form-field appearance="outline" class="readonly-field">
                    <mat-label>Net Amount</mat-label>
                    <input matInput formControlName="netAmount" />
                  </mat-form-field>
                   <mat-form-field appearance="outline" class="readonly-field">
                    <mat-label>Gross Amount</mat-label>
                    <input matInput formControlName="grossAmount" />
                  </mat-form-field>
                </div>
              </div>

              <div class="button-group">
                <button mat-button matStepperPrevious>Back</button>
                <button mat-raised-button class="buttons-end">Save</button>
                <button mat-raised-button class="buttons-end">Print</button>
                <button mat-raised-button class="buttons-end">Invoice</button>
              </div>
            </mat-card-content>
          </mat-card>
        </form>
      </mat-step>
    </mat-horizontal-stepper>
  </div>

  <mat-card class="summary">
    <mat-card-header>
      <mat-card-title>Live Summary</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <p><strong>Rental ID:</strong> 0000001</p>
      <p><strong>First Name:</strong> John</p>
      <p><strong>Last Name:</strong> Doe</p>
      <p><strong>Check Out:</strong> 01/04/2024</p>
      <p><strong>Check In:</strong> 10/04/2024</p>
      <p><strong>Net Amount:</strong> €300</p>
      <p><strong>Extras:</strong> €50</p>
      <p><strong>Gross Amount:</strong> €350</p>
    </mat-card-content>
  </mat-card>
</div>
